<!DOCTYPE html>
<html>
	<head>
		<meta charset="UTF-8">
		<meta name="viewport" content="width=device-width">
		<title>Passwort-Generator</title>
		<style>
			@font-face {
				font-family: "SF-Rounded";
				src: url("fonts/SF-Rounded.otf");
			}
			@font-face {
				font-family: "SF-Rounded-Bold";
				src: url("fonts/SF-Rounded-Bold.otf");
			}
			@font-face {
				font-family: "SF-Mono";
				src: url("fonts/SF-Mono.otf");
			}
			h1 {
				font-family: "SF-Rounded-Bold";
				font-size: 32 px;
			}
			h2 {
				font-family: "SF-Rounded-Bold";
				font-size: 24 px;
			}
			p, label, input, li {
				font-family: "SF-Rounded";
				font-size: 16 px;
				margin: 4px;
			}
			span {
				font-family: "SF-Mono";
				background-color: #BFBFBF;
				padding: 1px;
				border-radius: 4px;
			}
			#masterPassword, #websiteName, #websitePassword {
				font-family: "SF-Mono";
				border-radius: 4px;
				width: 256px;
			}
    	</style>
		<script src="crypto-js/crypto-js.js"></script>
	</head>
	<body> 
		<h1>Passwort-Generator</h1>
		<label for="masterPassword">Masterpasswort:</label>
		<input type="password" id="masterPassword">
		<label for="showMasterPassword">Masterpasswort anzeigen</label>
		<input type="checkbox" id="showMasterPassword">
		<br>
		<label for="websiteName">Webseitenname:</label>
		<input type="text" id="websiteName">
		<button onclick="calculatePassword()">Passwort berechnen</button>
		<br>
		<label for="websitePassword">Webseitenpasswort:</label>
		<input type="text" id="websitePassword" readonly>
		<h2>Was ist das?</h2>
		<p>Diese Webseite berechnet aus einem Masterpasswort in Kombination mit einem Webseitennamen ein pseudozufälliges Webseitenpasswort, bestehend aus Groß- und Kleinbuchstaben, Ziffern sowie <span>-</span> und <span>#</span>. Aus jeder Kombination von Masterpasswort und Webseitenname wird jedes Mal das gleiche Webseitenpasswort berechnet.</p>
		<h2>Ist das sicher? Wie funktioniert das?</h2>
		<p>Diese Webseite verwendet die kryptografische Hashfunktion SHA-256, die unter anderem vom deutschen <a href="https://www.bsi.bund.de/SharedDocs/Downloads/DE/BSI/Publikationen/TechnischeRichtlinien/TR02102/BSI-TR-02102.pdf?__blob=publicationFile">Bundesamt für Sicherheit in der Informationstechnik</a> sowie vom <a href="https://nvlpubs.nist.gov/nistpubs/FIPS/NIST.FIPS.180-4.pdf">National Institute of Standards and Technology</a> der Vereinigten Staaten als kryptografisch stark eingestuft wird. Das bedeutet, dass die Berechnung des Hashwerts nicht umkehrbar ist. Aus einem Webseitenpasswort kann daher weder das Masterpasswort noch der Webseitenname berechnet werden. Keine der hier eingegebenen Daten werden hochgeladen oder gespeichert. Das Webseitenpasswort wird jedes Mal neu aus dem Masterpasswort und dem Webseitennamen berechnet, die Berechnung erfolgt direkt auf dem Gerät. Der Quellcode kann <a href="https://github.com/F1248/F1248.github.io">auf Github</a> eingesehen werden. Für den Fall, dass diese Website nicht erreichbar sein sollte, gibt es eine identische <a href="offline.zip">Offline-Version</a>.</p>
		<h2>Fragen:</h2>
		<ul>
			<li>
				Kann ich das Masterpasswort ändern?<br>
				Nein, das Masterpasswort kann nicht geändert werden, ohne dass alle Webseitenpasswörter geändert werden. Stattdessen sollte alle paar Jahre ein neues Masterpasswort erstellt und alle Webseiten auf das neue Webseitenpasswort geändert werden.</p>
			</li>
			<li>
				Kann ich ein Webseitenpasswort ändern?<br>
				Nein, immer wenn die Kombination aus Masterpasswort und Webseitenname identisch ist, wird auch das gleiche Webseitenpasswort berechnet. Bei besonders wichtigen Passwörtern kann eine (Jahres-) Zahl angehängt werden, zum Beispiel <span>Bank22</span>, <span>Bank23</span>, <span>Bank...</span>, um jedes Jahr ein neues Webseitenpasswort verwenden zu können, das dann auf der Webseite geändert werden muss.
			</li>
		</ul>
		<h2>Technische Dokumentation:</h2>
		<p>Das Webseitenpasswort wird wie folgt berechnet:</p>
		<ol>
			<li>
				Das Masterpasswort und der Webseitenname werden zusammengesetzt.<br>
				<span>Passwort</span> + <span>Webseitenname</span> → <span>PasswortWebseitenname</span>
			</li>
			<li>
				Daraus wird mit der <a href="https://github.com/brix/crypto-js">crypto-js-Bibliotetk</a> der SHA-256-Hashwert berechnet.<br>
				<span>PasswortWebseitenname</span> → <span>1D66DD438AB5E6E91924CEC7C3D8A4E2DBB4D478DB252806691F6E04C2B1F370</span>
			</li>
			<li>
				Die ersten 16 Zweiergruppen des Hashwerts werden jeweils in eine Binärzahl umgerechnet.
				<ol>
					<li><span>1D</span> → <span>00011101</span></li>
					<li><span>66</span> → <span>01100110</span></li>
					<li><span>DD</span> → <span>11011101</span></li>
					<li><span>43</span> → <span>01000011</span></li>
					<li><span>……</span> → <span>……………………</span></li>
				</ol>
			</li>
			<li>
				Die Binärzahl wird auf die letzten sechs Stellen gekürzt.
				<ol>
					<li><span>00011101</span> → <span>011101</span></li>
					<li><span>01100110</span> → <span>100110</span></li>
					<li><span>11011101</span> → <span>011101</span></li>
					<li><span>01000011</span> → <span>000011</span></li>
					<li><span>……………………</span> → <span>………………</span></li>
				</ol>
			</li>
			<li>
				Die Binärzahl wird in eine Dezimalzahl umgerechnet.
				<ol>
					<li><span>011101</span> → <span>29</span></li>
					<li><span>100110</span> → <span>46</span></li>
					<li><span>011101</span> → <span>29</span></li>
					<li><span>000011</span> → <span>03</span></li>
					<li><span>………………</span> → <span>……</span></li>
				</ol>
			</li>
			<li>
				Das Zeichen an der entsprechenden Stelle dieses Strings <span>ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-#</span> wird an das Passwort angehängt.
				<ol>
					<li><span>29</span> → <span>d</span></li>
					<li><span>46</span> → <span>m</span></li>
					<li><span>29</span> → <span>d</span></li>
					<li><span>03</span> → <span>D</span></li>
					<li><span>……</span> → <span>…</span></li>
				</ol>
			</li>
		</ol>
		<p>2023, erstellt von <a href="https://github.com/F1248">F1248</a></p>
		<p><a href="https://github.com/F1248/F1248.github.io">Quellcode auf Github</a></p>
		<script>
			document.getElementById("showMasterPassword").addEventListener("change", function() {
				if (document.getElementById("showMasterPassword").checked) {
					document.getElementById("masterPassword").type = "text";
				} else {
					document.getElementById("masterPassword").type = "password";
				}
			});
			function calculatePassword() {
				const characters = "ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-#";
				let masterPassword = document.getElementById("masterPassword").value;
				let websiteName = document.getElementById("websiteName").value;
				let string = masterPassword + websiteName;
				let hash = CryptoJS.SHA256(string).toString();
				let websitePassword = "";
				for (let character_index = 0; character_index < 16; character_index++) {
					let hex1_index = character_index * 2;
					let hex2_index = hex1_index + 1;
					let hex1 = hash[hex1_index];
					let hex2 = hash[hex2_index];
					let hex = hex1 + hex2;
					let binary = parseInt(hex, 16).toString(2);
					let binary_length = binary.length
					if (binary_length > 6) {
						binary = binary.slice(binary_length - 6, binary_length);
					}
					let dezimal = parseInt(binary, 2);
					let character = characters[dezimal];
					websitePassword = websitePassword + character;
				}
				document.getElementById("websitePassword").value = websitePassword;
			}
		</script>
	</body>
</html>